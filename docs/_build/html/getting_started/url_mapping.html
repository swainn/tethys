

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>URL Mapping &mdash; Tethys Platform 0.1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/default_favicon.ico"/>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Tethys Platform 0.1.0 documentation" href="../index.html"/>
        <link rel="up" title="Getting Started" href="../getting_started.html"/>
        <link rel="next" title="Advanced Concepts" href="url_variables.html"/>
        <link rel="prev" title="The Controller" href="controller.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../index.html" class="fa fa-home"> Tethys Platform</a>
        
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../features.html#develop-web-apps">Develop Web Apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features.html#python-software-development-kit">Python Software Development Kit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features.html#templating-and-gizmos">Templating and Gizmos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features.html#developer-tools">Developer Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features.html#spatial-data">Spatial Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features.html#data-store">Data Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features.html#computing">Computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features.html#production-ready">Production Ready</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features.html#acknowledgements">Acknowledgements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation/linux.html">Installation on Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/mac.html">Installation on Mac OSX !</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/windows.html">Installation on Windows !</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/web_admin_setup.html">Web Admin Setup</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../getting_started.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="scaffold.html">Create a New Tethys App Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html">The Model and Persistent Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="view.html">The View and Templating</a></li>
<li class="toctree-l2"><a class="reference internal" href="controller.html">The Controller</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">URL Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="url_variables.html">Advanced Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="forms.html">User Input and Forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="distribution.html">Distributing Apps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tethys_sdk.html">Software Development Kit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tethys_sdk/app_class.html">App Base Class API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tethys_sdk/templating.html">App Templating API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tethys_sdk/gizmos.html">Template Gizmos API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tethys_sdk/dataset_services.html">Dataset Services API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tethys_sdk/persistent_store.html">Persistent Stores API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tethys_sdk/spatial_persistent_store.html">Spatial Persistent Stores API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tethys_sdk/spatial_publishing.html">Spatial Data Publishing API !</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tethys_sdk/geoprocessing.html">Web Processing Services API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tethys_sdk/visualizing.html">Data Visualization API !</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tethys_sdk/cloud_computing.html">Distributed Computing API !</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tethys_sdk/tethys_cli.html">Command Line Interface</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tethys_portal.html">Tethys Portal</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tethys_portal.html#administrator">Administrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tethys_portal.html#customize">Customize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tethys_portal.html#manage-users-and-permissions">Manage Users and Permissions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../production.html">Production Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../production.html#install-tethys-portal">1. Install Tethys Portal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production.html#install-apache-and-dependencies">2. Install Apache and Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production.html#make-baseline-virtual-environment">3. Make BASELINE Virtual Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production.html#set-wsgi-python-home">4. Set WSGI Python Home</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production.html#modify-wsgi-py-script">5. Modify <tt class="file docutils literal"><span class="pre">wsgi.py</span></tt> Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production.html#make-directory-for-static-files">6. Make Directory for Static Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production.html#set-secure-settings">7. Set Secure Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production.html#create-apache-site-configuration-file">8. Create Apache Site Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production.html#install-apps">11. Install Apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production.html#setup-the-persistent-stores-for-apps">12. Setup the Persistent Stores for Apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production.html#run-collect-static">13. Run Collect Static</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production.html#enable-site-and-restart-apache">14. Enable Site and Restart Apache</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../repos.html">Source Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../supplementary.html">Supplementary</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../supplementary/key_concepts.html">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../supplementary/app_project.html">App Project Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../supplementary/terminal_quick_guide.html">Terminal Quick Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../supplementary/install_ubuntu.html">Ubuntu Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../supplementary/ckan_troubleshooting.html">CKAN Installation Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../supplementary/docker_testing.html">Test Docker Containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../supplementary/pgadmin.html">PGAdmin III Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../supplementary/dev_environment.html">Setup Development Environment !</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../summary.html">Summary of References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Tethys Platform</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../getting_started.html">Getting Started</a> &raquo;</li>
      
    <li>URL Mapping</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/getting_started/url_mapping.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="url-mapping">
<h1>URL Mapping<a class="headerlink" href="#url-mapping" title="Permalink to this headline">¶</a></h1>
<p><strong>Last Updated:</strong> November 13, 2014</p>
<p>Whenever you create a new controller, you will also need to associate it with a URL by creating URL map for it. When a URL is requested, the controller that it is mapped to will be executed.</p>
<p>In this tutorial you will create a new URL map for the new <tt class="docutils literal"><span class="pre">map</span></tt> controller you created in the previous tutorial.</p>
<div class="section" id="map-controller-to-url">
<h2>Map Controller to URL<a class="headerlink" href="#map-controller-to-url" title="Permalink to this headline">¶</a></h2>
<p>Mapping a controller to a URL is performed in the <a class="reference internal" href="../glossary.html#term-app-configuration-file"><em class="xref std std-term">app configuration file</em></a> (<tt class="file docutils literal"><span class="pre">app.py</span></tt>). Open your app configuration file located at <tt class="file docutils literal"><span class="pre">my_first_app/app.py</span></tt>. Your <a class="reference internal" href="../glossary.html#term-app-class"><em class="xref std std-term">app class</em></a> will already have a method called <tt class="docutils literal"><span class="pre">url_maps()</span></tt>. This method must return a list or tuple of <tt class="docutils literal"><span class="pre">UrlMap</span></tt> objects. <tt class="docutils literal"><span class="pre">UrlMap</span></tt> objects require three attributes: <tt class="docutils literal"><span class="pre">name</span></tt>, <tt class="docutils literal"><span class="pre">url</span></tt>, and <tt class="docutils literal"><span class="pre">controller</span></tt>.</p>
<p>Your <a class="reference internal" href="../glossary.html#term-app-class"><em class="xref std std-term">app class</em></a> will already have one <tt class="docutils literal"><span class="pre">UrlMap</span></tt> for the home page called &#8220;home&#8221;. Add a new <tt class="docutils literal"><span class="pre">UrlMap</span></tt> object for the <tt class="docutils literal"><span class="pre">map</span></tt> controller that you created in the previous step. Give it a name of &#8220;map&#8221;, a url of &#8220;my-first-app/map&#8221;, and a path to the controller of &#8220;my_first_app.controllers.map&#8221;. The <tt class="docutils literal"><span class="pre">url_maps()</span></tt> method for your app should look something like this when you are done:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyFirstApp</span><span class="p">(</span><span class="n">TethysAppBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tethys App Class for My First App.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;My First App&#39;</span>
    <span class="n">index</span> <span class="o">=</span> <span class="s">&#39;my_first_app:home&#39;</span>
    <span class="n">icon</span> <span class="o">=</span> <span class="s">&#39;my_first_app/images/icon.gif&#39;</span>
    <span class="n">package</span> <span class="o">=</span> <span class="s">&#39;my_first_app&#39;</span>
    <span class="n">root_url</span> <span class="o">=</span> <span class="s">&#39;my-first-app&#39;</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s">&#39;#3498db&#39;</span>

    <span class="k">def</span> <span class="nf">url_maps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add controllers</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">UrlMap</span> <span class="o">=</span> <span class="n">url_map_maker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_url</span><span class="p">)</span>

        <span class="n">url_maps</span> <span class="o">=</span> <span class="p">(</span><span class="n">UrlMap</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;home&#39;</span><span class="p">,</span>
                           <span class="n">url</span><span class="o">=</span><span class="s">&#39;my-first-app&#39;</span><span class="p">,</span>
                           <span class="n">controller</span><span class="o">=</span><span class="s">&#39;my_first_app.controllers.home&#39;</span>
                           <span class="p">),</span>
                    <span class="n">UrlMap</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;map&#39;</span><span class="p">,</span>
                           <span class="n">url</span><span class="o">=</span><span class="s">&#39;my-first-app/map&#39;</span><span class="p">,</span>
                           <span class="n">controller</span><span class="o">=</span><span class="s">&#39;my_first_app.controllers.map&#39;</span>
                           <span class="p">),</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">url_maps</span>

    <span class="k">def</span> <span class="nf">persistent_stores</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add one or more persistent stores</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">stores</span> <span class="o">=</span> <span class="p">(</span><span class="n">PersistentStore</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;stream_gage_db&#39;</span><span class="p">,</span>
                                  <span class="n">initializer</span><span class="o">=</span><span class="s">&#39;init_stores:init_stream_gage_db&#39;</span><span class="p">,</span>
                                  <span class="n">spatial</span><span class="o">=</span><span class="bp">True</span>
                <span class="p">),</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">stores</span>
</pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">All of the URL patterns for your app should begin with the base URL of your app (e.g.: &#8216;my-first-app&#8217;) to prevent conflicts with other apps.</p>
</div>
<p>Now that you have created the URL map for your new map page, you can create a link to it from the home page. Open the <tt class="file docutils literal"><span class="pre">home.html</span></tt> template located at <tt class="file docutils literal"><span class="pre">my_first_app/templates/my_first_app/home.html</span></tt>. Replace the <tt class="docutils literal"><span class="pre">app_actions</span></tt> template block with the following:</p>
<div class="highlight-python"><div class="highlight"><pre>{% block app_actions %}
  &lt;a href=&quot;{% url &#39;my_first_app:map&#39; %}&quot; class=&quot;btn btn-default&quot;&gt;Go To Map&lt;/a&gt;
{% endblock %}
</pre></div>
</div>
<p>In this code, the <tt class="docutils literal"><span class="pre">url</span></tt> template tag is used to provide the url to the map page. It accepts a string with the following pattern: <tt class="docutils literal"><span class="pre">&quot;name_of_app:name_of_url_map&quot;</span></tt>. The advantage of using the <tt class="docutils literal"><span class="pre">url</span></tt> tag as opposed to hard coding the URL is that if the URL ever needs to be changed, you will only need to change it in your app configuration file and not in every template that references that URL.</p>
</div>
<div class="section" id="view-new-map-page">
<h2>View New Map Page<a class="headerlink" href="#view-new-map-page" title="Permalink to this headline">¶</a></h2>
<p>At this point, your app should be ready to run again. Save all changes in the files you edited and restart the development server using the <tt class="docutils literal"><span class="pre">tethys</span> <span class="pre">manage</span> <span class="pre">start</span></tt> command in the terminal (stop it using <tt class="kbd docutils literal"><span class="pre">CTRL-C</span></tt> if necessary). Browse to your app home page at <a class="reference external" href="http://127.0.0.1:8000/apps/my-first-app">http://127.0.0.1:8000/apps/my-first-app</a>. Use the &#8220;Go To Map&#8221; action to browse to your new map page. It should look similar to this:</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/new_map_page.png"><img alt="../_images/new_map_page.png" src="../_images/new_map_page.png" style="width: 650px;" /></a>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="url_variables.html" class="btn btn-neutral float-right" title="Advanced Concepts">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="controller.html" class="btn btn-neutral" title="The Controller"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Nathan Swain.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>