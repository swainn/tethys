<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Installation &mdash; Tethys Platform 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Tethys Platform 0.1.0 documentation" href="index.html" />
    <link rel="next" title="Getting Started" href="getting_started.html" />
    <link rel="prev" title="Features" href="features.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="getting_started.html" title="Getting Started"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="features.html" title="Features"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Tethys Platform 0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p><strong>Last Updated:</strong> October 18, 2014</p>
<p>This section describes how to install Tethys Platform. These installation instructions are optimized for Ubuntu 14.04,
which is the recommended platform for running Tethys Platform. However, these instructions should work with other
types of Linux with some adaptation.</p>
<div class="section" id="install-the-dependencies">
<h2>1. Install the Dependencies<a class="headerlink" href="#install-the-dependencies" title="Permalink to this headline">¶</a></h2>
<p>If you are using a Debian-based operating system (like Ubuntu), you can install the dependencies as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo apt-get install postgresql-9.3 postgresql-9.3-postgis-2.1 python-pip python-virtualenv git-core
</pre></div>
</div>
<p>If you not using a Debian-based operating system find the best way to install the following dependencies for your
operating system:</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Dependency</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Python</td>
<td><a class="reference external" href="https://www.python.org/download/releases/2.7/">Python Programming Language, version 2.7.</a></td>
</tr>
<tr class="row-odd"><td>PostgreSQL</td>
<td><a class="reference external" href="http://www.postgresql.org/download/">PostgreSQL database system, version 9.0 or higher (9.3 recommended).</a></td>
</tr>
<tr class="row-even"><td>PostGIS 2.1</td>
<td><a class="reference external" href="http://postgis.net/install">PostGIS spatial extension for PostgreSQL, version 2.1 or higher.</a></td>
</tr>
<tr class="row-odd"><td>GeoServer</td>
<td><a class="reference external" href="http://docs.geoserver.org/stable/en/user/installation/index.html">GeoServer server for sharing geospatial data.</a></td>
</tr>
<tr class="row-even"><td>Tomcat</td>
<td><a class="reference external" href="http://tomcat.apache.org/download-70.cgi">Tomcat open source Java Servlet, version 7.0.</a></td>
</tr>
<tr class="row-odd"><td>52°North WPS</td>
<td><a class="reference external" href="http://52north.org/communities/geoprocessing/wps/installation.html">52°North open source web processing service for geoprocessing.</a></td>
</tr>
<tr class="row-even"><td>GRASS GIS</td>
<td><a class="reference external" href="http://grass.osgeo.org/download/">GRASS GIS open source geospatial data management and analysis system, version 7.</a></td>
</tr>
<tr class="row-odd"><td>CKAN</td>
<td><a class="reference external" href="http://docs.ckan.org/en/latest/maintaining/installing/index.html">CKAN open source data management system.</a></td>
</tr>
<tr class="row-even"><td>wps-grass-bridge</td>
<td><a class="reference external" href="https://code.google.com/p/wps-grass-bridge/">Libraries and applications for easy and convenient GRASS7 GIS WPS integration.</a></td>
</tr>
<tr class="row-odd"><td>pip</td>
<td><a class="reference external" href="http://pip.readthedocs.org/en/latest/installing.html">Python package management and installation tool.</a></td>
</tr>
<tr class="row-even"><td>virtualenv</td>
<td><a class="reference external" href="http://virtualenv.readthedocs.org/en/latest/virtualenv.html#installation">virtualenv isolated Python environment creator.</a></td>
</tr>
<tr class="row-odd"><td>git</td>
<td><a class="reference external" href="http://git-scm.com/downloads">Git open source distributed version control system.</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="configure-dependencies">
<h2>2. Configure Dependencies<a class="headerlink" href="#configure-dependencies" title="Permalink to this headline">¶</a></h2>
<p>TODO: Add stuff here.</p>
<ul class="simple">
<li>PostGIS environmental variables to enable GDAL drivers</li>
</ul>
</div>
<div class="section" id="install-tethys-platform-into-a-python-virtual-environment">
<h2>3. Install Tethys Platform into a Python Virtual Environment<a class="headerlink" href="#install-tethys-platform-into-a-python-virtual-environment" title="Permalink to this headline">¶</a></h2>
<p>Python virtual environments are used to create isolated Python installations to avoid conflicts with dependencies of
other Python applications on the same system. The following commands should be executed in a the Terminal.</p>
<ol class="loweralpha">
<li><p class="first">Create a Python virtual environment and activate it:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo mkdir -p /usr/lib/tethys
sudo chown `whoami` /usr/lib/tethys
virtualenv --no-site-packages /usr/lib/tethys
. /usr/lib/tethys/bin/activate
</pre></div>
</div>
</li>
</ol>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>The final command above activates the Python virtual environment for Tethys. You can tell if a virtual environment
is active, because the name of it will appear in parenthesis in front of your terminal cursor:</p>
<div class="highlight-python"><div class="highlight"><pre>(tethys) $ _
</pre></div>
</div>
<p>The Tethys virtual environment must remain active for the entire installation. If you need to logout or close the
Terminal in the middle of the installation, you will need to reactivate the virtual environment. This can be done
at anytime by executing the following command (don&#8217;t forget the dot):</p>
<div class="last highlight-python"><div class="highlight"><pre>. /usr/lib/tethys/bin/activate
</pre></div>
</div>
</div>
<ol class="loweralpha" start="2">
<li><p class="first">Install Tethys Platform into the virtual environment with the following commands:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo mkdir -p /usr/lib/tethys/src
sudo chown `whoami` /usr/lib/tethys/src
cd /usr/lib/tethys/src
git clone https://github.com/swainn/tethys
</pre></div>
</div>
</li>
<li><p class="first">Install the Python modules that Tethys requires:</p>
<div class="highlight-python"><div class="highlight"><pre>pip install -r /usr/lib/tethys/src/requirements.txt
</pre></div>
</div>
</li>
<li><p class="first">Restart the Python virtual environment:</p>
<div class="highlight-python"><div class="highlight"><pre>deactivate
. /usr/lib/tethys/bin/activate
</pre></div>
</div>
</li>
</ol>
<div class="section" id="download-source">
<h3>1. Download Source<a class="headerlink" href="#download-source" title="Permalink to this headline">¶</a></h3>
<p>Download the source for the CKAN Apps plugin using git. In a terminal execute the following commands:</p>
<div class="highlight-python"><div class="highlight"><pre>$ mkdir ~/tethysdev
$ cd ~/tethysdev
$ git clone https://swainn@bitbucket.org/swainn/ckanext-tethys_apps.git
</pre></div>
</div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">The &#8220;~&#8221; (tilde) character is a shortcut to the home directory in a unix terminal. Thus, <tt class="file docutils literal"><span class="pre">~/tethysdev</span></tt> refers to a directory called &#8220;tethysdev&#8221; in the home directory.</p>
</div>
</div>
<div class="section" id="install-into-python">
<h3>2. Install into Python<a class="headerlink" href="#install-into-python" title="Permalink to this headline">¶</a></h3>
<p>Activate your CKAN Python virtual environment, change into the <tt class="file docutils literal"><span class="pre">ckanext-tethys_apps</span></tt> directory, and run the setup script. If you have used the defaults for installing CKAN, this can be done like so:</p>
<div class="highlight-python"><div class="highlight"><pre>$ . /usr/lib/ckan/default/bin/activate
$ cd ~/tethysdev/ckanext-tethys_apps
$ python setup.py install
</pre></div>
</div>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">Don&#8217;t forget the &#8221;.&#8221; operator when activating your Python environment. This is needed to execute the <tt class="file docutils literal"><span class="pre">activate</span></tt> script.</p>
</div>
</div>
<div class="section" id="modify-ckan-configuration">
<h3>3. Modify CKAN Configuration<a class="headerlink" href="#modify-ckan-configuration" title="Permalink to this headline">¶</a></h3>
<p>Add the term &#8220;tethys_apps&#8221; to the <strong>ckan.plugins</strong> parameter of your CKAN configuration (e.g.: <tt class="file docutils literal"><span class="pre">/etc/ckan/default/development.ini</span></tt>). The parameter should look similar to this when your done:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ckan</span><span class="o">.</span><span class="n">plugins</span> <span class="o">=</span> <span class="n">tethys_apps</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Depending on the different plugins that are enabled for your CKAN installation, the <strong>ckan.plugins</strong> parameters may have several other plugin names listed with &#8220;tethys_apps&#8221;. This is ok.</p>
</div>
</div>
<div class="section" id="copy-the-source-directory">
<h3>4. Copy the Source Directory<a class="headerlink" href="#copy-the-source-directory" title="Permalink to this headline">¶</a></h3>
<p>Copy the <tt class="file docutils literal"><span class="pre">tethys_apps</span></tt> directory from the source into the <tt class="file docutils literal"><span class="pre">ckanext</span></tt> directory of the CKAN source. This can be done like so:</p>
<div class="highlight-python"><div class="highlight"><pre>$ cp ~/tethysdev/ckanext-tethys_apps/ckanext/tethys_apps /usr/lib/ckan/src/ckan/ckanext/
</pre></div>
</div>
</div>
<div class="section" id="create-database-users">
<h3>5. Create Database Users<a class="headerlink" href="#create-database-users" title="Permalink to this headline">¶</a></h3>
<p>Create a database user and database for Tethys Apps. The plugin needs it&#8217;s own database user to assist with the automatic database provisioning feature. Create the user and give it a password using hte interactive prompt. You will need to remember this password for the next step.</p>
<div class="highlight-python"><div class="highlight"><pre>$ sudo -u postgres createuser -S -d -R -P tethys_db_manager
$ sudo -u postgres createdb -O tethys_db_manager tethys_db_manager -E utf-8
</pre></div>
</div>
<p>Next, create a database superuser for Tethys and it&#8217;s associtated database. Remember the password that you assign to this user for the next step.</p>
<div class="highlight-python"><div class="highlight"><pre>$ sudo -u postgres createuser --superuser -d -R -P tethys_super
$ sudo -u postgres createdb -O tethys_super tethys_super -E utf-8
</pre></div>
</div>
</div>
<div class="section" id="modify-the-tethys-apps-config">
<h3>6. Modify the Tethys Apps Config<a class="headerlink" href="#modify-the-tethys-apps-config" title="Permalink to this headline">¶</a></h3>
<p>Open the Tethys Apps configuration file (<tt class="file docutils literal"><span class="pre">/usr/lib/ckan/default/src/ckan/ckanext/tethys_apps/tethys_apps.ini</span></tt>) and edit the <tt class="docutils literal"><span class="pre">tethys.database_manager_url</span></tt> and <tt class="docutils literal"><span class="pre">tethys.superuser_url</span></tt> parameters so that the username, password, host, port, and database match the databases and users that you created in the last step. The url uses the following pattern:</p>
<div class="highlight-python"><div class="highlight"><pre>postgresql://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;database&gt;
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">tethys.database_manager_url</span></tt>  and <tt class="docutils literal"><span class="pre">tethys.superuser_url</span></tt> parameters should look something like this when you are done:</p>
<div class="highlight-python"><div class="highlight"><pre>tethys.database_manager_url = postgresql://tethys_db_manager:pass@localhost:5432/tethys_db_manager
tethys.superuser_url = postgresql://tethys_super:pass@localhost:5432/tethys_super
</pre></div>
</div>
<p>Next, make sure the <tt class="docutils literal"><span class="pre">tethys.ckanapp_directory</span></tt> parameter is set to the path to your <tt class="file docutils literal"><span class="pre">ckanapp</span></tt> directory. For a default installation of CKAN and Tethys Apps, this will be at <tt class="file docutils literal"><span class="pre">/usr/lib/ckan/default/src/ckan/ckanext/tethys_apps/ckanapp</span></tt>. This parameter should look similar to this when you are done:</p>
<div class="highlight-python"><div class="highlight"><pre>tethys.ckanapp_directory = /usr/lib/ckan/default/src/ckan/ckanext/tethys_apps/ckanapp
</pre></div>
</div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Do <strong>NOT</strong> use double or single quotes for the url or directory parameters in the Tethys configuration file.</p>
</div>
</div>
<div class="section" id="start-ckan">
<h3>7. Start CKAN<a class="headerlink" href="#start-ckan" title="Permalink to this headline">¶</a></h3>
<p>Deactivate and reactivate your CKAN Python virtual environment and start up the Paster server:</p>
<div class="highlight-python"><div class="highlight"><pre>$ deactivate
$ . /usr/lib/ckan/default/bin/activate
$ paster serve /etc/ckan/default/development.ini
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If your virtual environment was already deactivated the <strong class="command">deactivate</strong> command will fail. This is ok. Just activate your virtual environment and start paster server.</p>
</div>
<p>Navigate to your CKAN page in a web browser (likely at <a class="reference external" href="http://localhost:5000">http://localhost:5000</a>). Installation has been successful if the <em class="guilabel">Apps</em> link appears in the header of your CKAN page.</p>
</div>
<div class="section" id="working-with-tethys-under-development">
<h3>Working With Tethys Under Development<a class="headerlink" href="#working-with-tethys-under-development" title="Permalink to this headline">¶</a></h3>
<p>The Tethys Apps plugin is currently under heavy development. It is likely that you will want to pull the latest changes frequently until a stable version is released. To prevent the need to reinstall the app everytime you pull changes, you will need to use the following modifications when installing the Tethys Apps plugin:</p>
<p>Use the <strong class="command">develop</strong> command instead of the <strong class="command">install</strong> command  when running the setup script. This creates a link between the Tethys Apps source and Python instead of hard copying it. This will allow any changes you pull to be propegated without reinstalling the plugin.</p>
<div class="highlight-python"><div class="highlight"><pre>$ . /usr/lib/ckan/default/bin/activate
$ cd ~/tethysdev/ckanext-tethys_apps
$ python setup.py develop
</pre></div>
</div>
<p>Create a symbolic link between <tt class="file docutils literal"><span class="pre">tethys_apps</span></tt> and <tt class="file docutils literal"><span class="pre">ckanext</span></tt>, rather than copying for the same reasons as above:</p>
<div class="highlight-python"><div class="highlight"><pre>$ ln -s ~/tethysdev/ckanext-tethys_apps/ckanext/tethys_apps /usr/lib/ckan/default/src/ckan/ckanext/tethys_apps
</pre></div>
</div>
</div>
</div>
<div class="section" id="pull-latest-changes">
<h2>Pull Latest Changes<a class="headerlink" href="#pull-latest-changes" title="Permalink to this headline">¶</a></h2>
<p>Changes can be pulled from the git repository like so:</p>
<div class="highlight-python"><div class="highlight"><pre>$ cd ~/tethysdev/ckanext-tethys_apps
$ git pull
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Installation</a><ul>
<li><a class="reference internal" href="#install-the-dependencies">1. Install the Dependencies</a></li>
<li><a class="reference internal" href="#configure-dependencies">2. Configure Dependencies</a></li>
<li><a class="reference internal" href="#install-tethys-platform-into-a-python-virtual-environment">3. Install Tethys Platform into a Python Virtual Environment</a><ul>
<li><a class="reference internal" href="#download-source">1. Download Source</a></li>
<li><a class="reference internal" href="#install-into-python">2. Install into Python</a></li>
<li><a class="reference internal" href="#modify-ckan-configuration">3. Modify CKAN Configuration</a></li>
<li><a class="reference internal" href="#copy-the-source-directory">4. Copy the Source Directory</a></li>
<li><a class="reference internal" href="#create-database-users">5. Create Database Users</a></li>
<li><a class="reference internal" href="#modify-the-tethys-apps-config">6. Modify the Tethys Apps Config</a></li>
<li><a class="reference internal" href="#start-ckan">7. Start CKAN</a></li>
<li><a class="reference internal" href="#working-with-tethys-under-development">Working With Tethys Under Development</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pull-latest-changes">Pull Latest Changes</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="features.html"
                        title="previous chapter">Features</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="getting_started.html"
                        title="next chapter">Getting Started</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/installation.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="getting_started.html" title="Getting Started"
             >next</a> |</li>
        <li class="right" >
          <a href="features.html" title="Features"
             >previous</a> |</li>
        <li><a href="index.html">Tethys Platform 0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Nathan Swain.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>